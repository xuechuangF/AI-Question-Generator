<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•ç»“æœ - æ™ºèƒ½é¢˜ç›®ç”Ÿæˆå™¨</title>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // æ¸²æŸ“æ‰€æœ‰LaTeXå…¬å¼
        if (window.MathJax) {
            MathJax.typesetPromise().catch((err) => console.log(err.message));
        }
    });
    </script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <div class="results-summary">
            <h1>ğŸ‰ æµ‹è¯•å®Œæˆï¼</h1>
            <div class="score-circle">
                <div class="score-text">
                    <div class="score-number">{{ "%.0f"|format(score) }}%</div>
                    <div class="score-label">æ€»åˆ†</div>
                </div>
            </div>
            <div class="score-details">
                <div class="score-item">
                    <span class="label">æ­£ç¡®é¢˜æ•°:</span>
                    <span class="value">{{ correct_count }} / {{ total_questions }}</span>
                </div>
                <div class="score-item">
                    <span class="label">ç”¨æ—¶:</span>
                    <span class="value">{{ "%.1f"|format(quiz_time/60) }} åˆ†é’Ÿ</span>
                </div>
            </div>
        </div>

        <div class="detailed-analysis">
            <h3>è¯¦ç»†è§£æ</h3>
            {% for result in results %}
            <div class="question-analysis {% if result.is_correct %}correct{% else %}incorrect{% endif %}">
                <div class="analysis-header">
                    <span>ç¬¬ {{ loop.index }} é¢˜</span>
                    <span class="badge {% if result.is_correct %}bg-success{% else %}bg-danger{% endif %}">
                        {% if result.is_correct %}æ­£ç¡®{% else %}é”™è¯¯{% endif %}
                    </span>
                </div>
                <div class="analysis-content">
                    <p><strong>é¢˜ç›®ï¼š</strong>{{ result.question }}</p>
                    <p><strong>æ‚¨çš„ç­”æ¡ˆï¼š</strong>{{ result.options.get(result.user_answer, 'æœªä½œç­”') }}</p>
                    <p><strong>æ­£ç¡®ç­”æ¡ˆï¼š</strong>{{ result.options[result.correct_answer] }}</p>
                    <p><strong>è§£æï¼š</strong>{{ result.explanation }}</p>
                </div>
            </div>
            {% endfor %}
        </div>

        <div class="button-group text-center mt-4">
            <a href="/download/{{ session_id }}/html" class="btn btn-primary">
                <i class="fas fa-download"></i> ä¸‹è½½HTMLæŠ¥å‘Š
            </a>
            <a href="/download/{{ session_id }}/json" class="btn btn-secondary">
                <i class="fas fa-file-code"></i> ä¸‹è½½JSONæ•°æ®
            </a>
            <a href="/" class="btn btn-outline-primary">
                <i class="fas fa-home"></i> è¿”å›é¦–é¡µ
            </a>
        </div>
    </div>
</body>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // ç­‰å¾…MathJaxåŠ è½½å®Œæˆåæ¸²æŸ“
    if (window.MathJax) {
        window.MathJax.startup.promise.then(() => {
            if (window.MathJax.typesetPromise) {
                window.MathJax.typesetPromise().catch((err) => console.log(err.message));
            }
        });
    }
});
</script>
</html>